window.formVisibilityGroups=function(){var e={template:'\n           <div>\n        <ul class="list-group">\n            \x3c!-- Loop through each group --\x3e\n            <li class="list-group-item" v-for="(group, groupIndex) in groups" :key="groupIndex">\n                <div class="d-flex justify-content-between mb-2">\n                    <span>Group {{ groupIndex + 1 }}</span>\n                    <input type="hidden" :name="prefix + \'Groups[\' + groupIndex + \'].IsRemoved\'" value="false" />\n                    <button type="button" class="btn btn-sm btn-danger" @click="removeGroup(groupIndex)">\n                        <i class="fa-solid fa-trash"></i> Remove Group\n                    </button>\n                </div>\n\n                \x3c!-- Loop through each rule --\x3e\n                <ul class="list-group mb-3">\n                    \x3c!-- Loop through each rule in the group --\x3e\n                    <li class="list-group-item" v-for="(rule, ruleIndex) in group.rules" :key="ruleIndex">\n                        <div class="row">\n                            <div class="col">\n                                <select class="form-select" v-model="rule.field" :name="prefix + \'Groups[\' + groupIndex + \'].Rules[\' + ruleIndex + \'].Field\'">\n                                    <option value="">Select Field</option>\n                                    <option v-for="option in fieldOptions" :value="option.value">\n                                        {{ option.text }}\n                                    </option>\n                                </select>\n                            </div>\n\n                            <div class="col">\n                                <select class="form-select" v-model="rule.operator" :name="prefix + \'Groups[\' + groupIndex + \'].Rules[\' + ruleIndex + \'].Operator\'">\n                                    <option value="">Select Operator</option>\n                                    <option v-for="option in operatorOptions" :value="option.value">\n                                        {{ option.text }}\n                                    </option>\n                                </select>\n                            </div>\n\n                            <div class="col">\n                                <input type="text" class="form-control" v-model="rule.value" placeholder="Value" :name="prefix + \'Groups[\' + groupIndex + \'].Rules[\' + ruleIndex + \'].Value\'" />\n                            </div>\n\n                            <div class="col-auto">\n                                <input type="hidden" :name="prefix + \'Groups[\' + groupIndex + \'].Rules[\' + ruleIndex + \'].IsRemoved\'" value="false" />\n                                <button type="button" class="btn btn-sm btn-danger" @click="removeRule(groupIndex, ruleIndex)">\n                                    <i class="fa-solid fa-trash"></i> Remove Rule\n                                </button>\n                            </div>\n                        </div>\n                    </li>\n                    <li class="list-group-item">\n                        <div class="d-flex justify-content-end mb-2">\n                            <button type="button" class="btn btn-sm btn-secondary" @click="addRule(groupIndex)">\n                                <i class="fa-solid fa-circle-plus"></i> New Rule\n                            </button>\n                        </div>\n                    </li>\n                </ul>\n            </li>\n            <li class="list-group-item">\n                <div class="d-flex justify-content-end">\n                    <button type="button" class="btn btn-sm btn-primary" @click="addGroup()">\n                        <i class="fa-solid fa-circle-plus"></i> New Group\n                    </button>\n                </div>\n            </li>\n        </ul>\n    </div>\n        '};return{initialize:function(n){var t=Object.assign({},e,n);if(t.appElementSelector){var o=0;return new Vue({el:t.appElementSelector,data:function(){return{groups:[],fieldOptions:t.fieldOptions||[],operatorOptions:[],prefix:""}},computed:{groupsJson:function(){return JSON.stringify(this.groups)}},methods:{addGroup:function(){this.groups.push({id:"group-"+o++,rules:[]})},addRule:function(e){var n={id:"rule-"+Date.now()+"-"+Math.floor(1e3*Math.random()),field:"",operator:"",value:""};this.groups[e].rules.push(n)},removeGroup:function(e){this.groups.splice(e,1)},removeRule:function(e,n){this.groups[e].rules.splice(n,1)},populateFields:function(){var e=this.getInputs();this.fieldOptions=e.map((function(e){return{value:e.htmlId,text:e.htmlName}}))},getInputs:function(){var e=document.querySelectorAll(".widget-template"),n=[];return e.forEach((function(e){var t=e.querySelector('input[name$="FormElementPart.Id"]'),o=e.querySelector('input[name$="FormInputElementPart.Name"]'),r=e.querySelector('select[name$="InputPart.Type"]');if(t&&r){var l=t.value,i=o.value,u=r.options[r.selectedIndex].value;if(!t.value||!u)return;n.push({htmlId:l,htmlName:i,htmlInputType:u})}})),n},findOperators:function(){var e=document.getElementById("operatorData");if(e)try{return JSON.parse(e.getAttribute("data-operators"))}catch(e){console.error("Error parsing operator data:",e)}return[]}},mounted:function(){var e=this;t.prefix&&(this.prefix=t.prefix+"."),console.log("config.appElementSelector:",t.appElementSelector),this.$nextTick((function(){e.populateFields(),console.log("Vue component mounted. Prefix is:",e.prefix),e.operatorOptions=e.findOperators()}))},template:t.template})}console.error("appElementSelector is required")}}}();
